# 이곡어때 - 노래방 추천 앱

노래방에서 지금 상황에 딱 맞는 노래를 추천해주는 웹 앱입니다.

## 📌 프로젝트 개요

### 서비스 목적
- 노래 실력과 무관하게 누구나 부담 없이 곡 선택 가능
- 분위기를 망치지 않는 곡 선택 지원
- CSV 데이터 기반 정확한 추천

### 핵심 기능 (2026.01.31 업데이트)

**1. 프로필 입력**
- 유저 성별, 연령대, 방문 빈도, 선호 장르

**2. 3단계 선택 → 맞춤 추천**
- 화면1: 나이 + 가수성별
- 화면2: 장르 + 분위기
- 화면3: 인원수 + 상황

**3. 추천 결과**
- 5곡 추천 (조건 필터링 + 랜덤)
- 후기 작성 및 저장 (localStorage)

## 🗂️ 파일 구조

```
project3/
├── index.html        # 메인 HTML (6개 화면)
├── index.css         # 스타일 (Cyan/Blue 네온 테마)
├── app.js            # 앱 로직 (프로필 + 3단계 선택 + 후기)
├── songs.js          # 노래 데이터 (250+ 곡 내장)
├── recommend.js      # 추천 알고리즘 (필터 기반)
├── recommend.md      # 알고리즘 상세 문서
├── song_matching_classified.csv  # 원본 분류 데이터 (4000+ 곡)
├── granite.config.ts # 앱인토스 설정 (기능스킴, 브랜드, 네비게이션바)
├── vite.config.js    # Vite 설정
├── package.json      # 의존성 설정
├── public/
│   └── logo.png      # 앱 로고 이미지
└── CLAUDE.md         # 프로젝트 문서
```

## 🎨 UI 플로우

```
스플래시 → 프로필 → 나이+가수성별 → 장르+분위기 → 인원수+상황 → 결과 + 후기
```

각 선택 화면에 **상관없음** 옵션 제공

## 📊 데이터 구조

### CSV 컬럼 → 앱 필드 매핑
| CSV 컬럼 | 앱 필드명 | 값 |
|---------|----------|-----|
| 나이 | 나이 | 10대, 20대, 30대, 40대, 50대+ |
| 성별 | 가수성별 | 남, 여, 남/여 |
| 장르 | 장르 | 발라드, 힙합, 댄스, 락, 트로트, R&B |
| 분위기 | 분위기 | 잔잔, 달달, 신나는, 우울한, 애절한 |
| 인원수 | 인원수 | 혼자, 듀엣, 그룹 |
| 상황 | 상황 | 감성충전, 분위기 띄우기, 데이트, 고음어필 |

## 🛠️ 기술 스택

- **Vite** - 번들러 (^6.0.0)
- **HTML5/CSS3/JS** - ES Module 구조
- **localStorage** - 후기 저장
- **Google Fonts** - Noto Sans KR
- **Apps In Toss** - 웹 프레임워크 (선택적)

## ⚙️ 추천 알고리즘 (recommend.js)

**우선순위 기반 점수 매칭 시스템:**

### 가중치
```javascript
분위기: 40점 (최우선)
상황: 35점
장르: 10점
인원수: 8점
나이: 4점
가수성별: 3점
```

### 프로세스
```javascript
recommend(userSelection, excludeList = []) {
    1. 제외 목록 필터링 (중복 방지)
    2. 모든 곡에 점수 부여 (조건별 가중치 합산)
    3. 점수순 정렬 (높은 점수 우선)
    4. 최소 점수 필터링 (핵심 조건 하나라도 맞으면 통과)
    5. 상위 30곡 중 랜덤 섞기 (다양성)
    6. 5곡 반환
}
```

**핵심**: 
- 분위기와 상황을 우선시하고, 나머지는 보너스 점수로 활용
- 다시 추천받기 시 이미 추천된 곡 제외 (중복 방지)

자세한 내용은 [recommend.md](./recommend.md) 참고

## 💬 후기 기능

- **저장**: localStorage에 후기 저장
- **표시**: 날짜, 내용, 선택 조건 함께 저장
- **삭제**: 개별 후기 삭제 가능

## 🚀 실행 방법

```bash
npm run dev
# localhost:5173 또는 5174 접속
```

## 📱 Apps In Toss 배포

- **앱 이름**: `joj-miniapp1`
- **기능스킴**: `intoss://joj-miniapp1` (딥링크로 앱 실행)
- **브랜드 아이콘**: `public/logo.png`
- **네비게이션바**: 뒤로가기 버튼 활성화
- `granite.config.ts` 설정 → `npm run ait:build` → `.ait` 파일 생성 후 배포

### 앱 내 기능 (딥링크)

| 한국어 기능 이름 | 영어 기능 이름 | 이동 URL |
|----------------|--------------|---------|
| 노래 추천받기 | Song Recommendation | `intoss://joj-miniapp1/recommend` |

- `/recommend` → 스플래시 스킵, 프로필 입력 화면으로 바로 이동
- 딥링크 처리 로직: `app.js` → `handleDeepLink()`

## ⚙️ 확장 가능성

1. **노래 DB 확장**: CSV 파일에서 더 많은 곡 로드
2. **후기 분석**: 인기 조건 조합 분석
3. **번호 검색**: 노래방 번호 연동 (TJ, 금영 등)
4. **서버 연동**: 후기를 서버 DB에 저장
